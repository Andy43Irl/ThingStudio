{
    "widget": {
        "title": "TwoSeventyDial",
        "widgetType": "Web Component",
        "tagName": "ts-twoseventydial",
        "parameters": [
            {
                "title": "value",
                "paramType": "Number",
                "required": true,
                "description": "The value to be displayed",
                "dummyValue": "42"
            },
            {
                "title": "calculations",
                "paramType": "[Numbers]",
                "required": false,
                "description": "MinMax calculations from Feed",
                "dummyValue": "{\"min\":10, \"max\": 80, \"avg\": 45}"
            },
            {
                "title": "legend",
                "paramType": "String",
                "required": false,
                "description": "Label for values",
                "dummyValue": "Boiler Pressure"
            },
            {
                "title": "Units",
                "paramType": "String",
                "required": false,
                "description": "Units",
                "dummyValue": "Bar"
            }
        ]
    },
    "template": {
        "title": "TwoSeventyDial",
        "html": "<!-- Replace this content with your own. -->\n<style>\n.lcdDisplay {\n\tfont-family:'LCDBOLD',Serif;\n}\n</style>\n<svg id=\"doc1\" viewBox=\"0, 0, 500, 500\">\n    <defs>\n         <path id=\"pie-seg\"  d=\"M250,250 L155,20  a250,250,0,0,1,190,0 L250,250 \" fill=\"#aaaaaa\" stroke-width=\"3\" stroke=\"none\"/>\n    </defs>\n        <use xlink:href=\"#pie-seg\" transform=\"rotate(-135 250 250)\"  fill-opacity=\"100%\"/>\n        <use xlink:href=\"#pie-seg\" transform=\"rotate(-90 250 250)\" fill-opacity=\"90%\"/>\n        <use xlink:href=\"#pie-seg\" transform=\"rotate(-45 250 250)\"  fill-opacity=\"80%\"/>\n        <use xlink:href=\"#pie-seg\" transform=\"rotate(0 250 250)\"  fill-opacity=\"70%\"/>\n        <use xlink:href=\"#pie-seg\" transform=\"rotate(45 250 250)\" fill-opacity=\"60%\"/>\n        <use xlink:href=\"#pie-seg\" transform=\"rotate(90 250 250)\"  fill-opacity=\"50%\"/>\n        <use xlink:href=\"#pie-seg\" transform=\"rotate(135 250 250)\"  fill-opacity=\"40%\"/>\n<!--path transform=\"rotate(0 250 250)\" d=\"M179.3,320.7  a100,100,0,1,1,141.4,0,0 L250, 250 l-70.7,70.7 \" fill=\"green\" stroke-width=\"3\" stroke=\"white\"/-->\n<path transform=\"rotate({{mappedValue value}} 250 250)\" d=\"M225,157  a100,100,0,1,0,50 ,0 l -25,-130 l -25,130 z\" fill=\"#333333\" stroke-width=\"10\" stroke=\"orange\"/>\n\n{{#with minmaxscaled calculations}}\n<circle transform=\"rotate({{min}} 250 250)\" cx=\"250\" cy=\"10\" r=\"10\" stroke=\"black\" stroke-width=\"1\" fill=\"red\" />\n<circle transform=\"rotate({{max}} 250 250)\" cx=\"250\" cy=\"10\" r=\"10\" stroke=\"black\" stroke-width=\"1\" fill=\"green\" />\n<circle transform=\"rotate({{avg}} 250 250)\" cx=\"250\" cy=\"10\" r=\"15\" stroke=\"black\" stroke-width=\"1\" fill=\"{{dirColor}}\" />\n<div>{{diff}}</div>\n\n{{/with}}\n<text class=\"lcdDisplay\"  text-anchor=\"middle\" font-size=\"80px\" x=\"250\" y=\"280\" fill=\"Orange\">{{value}}</text>\n<text  text-anchor=\"middle\" font-size=\"40px\" x=\"250\" y=\"440\" fill=\"Orange\">{{legend}}</text>\n<text  text-anchor=\"middle\" font-size=\"30px\" x=\"250\" y=\"480\" fill=\"Orange\">{{units}}</text>\n\n</svg>",
        "js": "Template[name].helpers({\n      mappedValue: function(value) {\n          console.log(\"T270\", value, this)\n        m =  mapValue(value, 0, 100, 0, 270)-135\n        return m;\n    },\n    minmaxscaled: function(json){\n        console.log(\"JS\", json)\n        calc = JSON.parse(json);\n        console.log(\"MM \", calc.avg, calc)\n        ret = {}\n       // ret.payload = mapValue(this.payload, 0, 120, 0, 200);\n        ret.diff = mapValue(calc.diff, 0, 100, 0, 270);\n        ret.min =  mapValue(calc.min, 0, 100, 0, 270)-135;\n        ret.max = mapValue(calc.max, 0, 100, 0, 270)-135;\n        ret.avg =  mapValue(calc.avg, 0, 100, 0, 270)-135;\n        ret.diffavg = mapValue(calc.diffavg, 0, 100, 0, 270);\n        console.log(\"REG\", ret)\n        return ret;\n    },\n    dirColor: function(){\n        return diffavg > 0 ? \"green\" : \"red\";\n    },\n    debug: function(p){\n        console.log(\"DEB: \", p, this)\n    }\n});",
        "isWidget": true
    }
}